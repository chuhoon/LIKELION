<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.1/redux.js"></script>
  </head>

  <body>
    <style>
      .container {
        width: 300px;
        height: 200px;
        border: 5px solid black;
        padding: 10px;
      }

      li {
        list-style: none;
        margin: 20px;
      }

      ul {
        display: flex;
        flex-wrap: wrap;
      }
    </style>
    <input id="input-txt" type="text" />
    <button id="txtBtn">버튼</button>
    <button id="red">red</button>
    <button id="green">green</button>
    <button id="blue">blue</button>
    <ul>
      <li id="one"></li>
      <li id="two"></li>
      <li id="three"></li>
      <li id="four"></li>
      <li id="five"></li>
      <li id="six"></li>
    </ul>
    <script>
      // state는 현재 상태, action은 주문 받은 것!
      function reducer(state, action) {
        console.log(state, action);
        // 초기값 노란색으로 받아옴
        if (state === undefined) {
          return { color: 'black', text: '' };
        }
        var newState;
        if (action.type === 'CHANGE_COLOR') {
          //복제해야 합니다. 그냥 {color:'red'}이런 식으로 리턴해줘도 되긴 하는데 리덕스의 고급기능을 쓰지 못합니다.
          // Object.assign({}, 빈객체에 복제할 값1, 빈객체에 복제할 값2...);
          newState = { ...state, color: action.color };
          console.log(state);
          console.log(newState);
        } else if (action.type === 'CHANGE_TEXT') {
          newState = { ...state, text: action.text };
          console.log(state);
          console.log(newState);
        }

        return newState;
      }
      // Redux는 cdn으로 생깁니다.
      var store = Redux.createStore(
        reducer,
        window.__REDUX_DEVTOOLS_EXTENSION__ &&
          window.__REDUX_DEVTOOLS_EXTENSION__() // redux dev tools를 사용하기 위한 코드
      );

      const textBtn = document.querySelector('#txtBtn');
      const inputTxt = document.querySelector('#input-txt');

      function onChangeTextBtn() {
        var state = store.getState();
        //type은 반드시 있어야 합니다.
        // 바뀔 때마다 console에 store.getState()를 실행해보세요.
        txtBtn.addEventListener('click', function () {
          console.log(inputTxt);
          store.dispatch({ type: 'CHANGE_TEXT', text: inputTxt.value });
        });
      }
      // 값이 바뀔 때마다 red 함수를 호출
      store.subscribe(onChangeTextBtn);
      onChangeTextBtn();

      function red() {
        var state = store.getState();
        //type은 반드시 있어야 합니다.
        // 바뀔 때마다 console에 store.getState()를 실행해보세요.
        const redBtn = document.querySelector('#red');
        redBtn.addEventListener('click', function () {
          store.dispatch({ type: 'CHANGE_COLOR', color: 'red' });
        });
      }
      // 값이 바뀔 때마다 red 함수를 호출
      store.subscribe(red);
      red();

      function green() {
        var state = store.getState();
        //type은 반드시 있어야 합니다.
        // 바뀔 때마다 console에 store.getState()를 실행해보세요.
        const greenBtn = document.querySelector('#green');
        greenBtn.addEventListener('click', function () {
          store.dispatch({ type: 'CHANGE_COLOR', color: 'green' });
        });
      }
      // 값이 바뀔 때마다 red 함수를 호출
      store.subscribe(green);
      green();

      function blue() {
        var state = store.getState();
        //type은 반드시 있어야 합니다.
        // 바뀔 때마다 console에 store.getState()를 실행해보세요.
        const blueBtn = document.querySelector('#blue');
        blueBtn.addEventListener('click', function () {
          store.dispatch({ type: 'CHANGE_COLOR', color: 'blue' });
        });
      }
      // 값이 바뀔 때마다 red 함수를 호출
      store.subscribe(blue);
      blue();

      function one() {
        var state = store.getState();
        //type은 반드시 있어야 합니다.
        // 바뀔 때마다 console에 store.getState()를 실행해보세요.
        document.querySelector('#one').innerHTML = `
                <div class="container" id="component_red" style="border-color:${state.color}; font-size:25px ">
                  ${state.text}
                </div>
            `;
      }
      // 값이 바뀔 때마다 red 함수를 호출
      store.subscribe(one);
      one();

      function two() {
        var state = store.getState();
        document.querySelector('#two').innerHTML = `
                <div class="container" id="component_blue" style="border-color:${state.color}; font-size:40px">
                  ${state.text}
                </div>
            `;
      }
      store.subscribe(two);
      two();

      function three() {
        var state = store.getState();
        document.querySelector('#three').innerHTML = `
                <div class="container" id="component_green" style="border-color:${state.color}; font-size:14px">
                  ${state.text}
                </div>
            `;
      }
      store.subscribe(three);
      three();

      function four() {
        var state = store.getState();
        document.querySelector('#four').innerHTML = `
                <div class="container" id="component_green" style="border-color:${state.color}; font-size:32px">
                  ${state.text}
                </div>
            `;
      }
      store.subscribe(four);
      four();

      function five() {
        var state = store.getState();
        document.querySelector('#five').innerHTML = `
                <div class="container" id="component_green" style="border-color:${state.color}; font-size:50px">
                  ${state.text}
                </div>
            `;
      }
      store.subscribe(five);
      five();

      function six() {
        var state = store.getState();
        document.querySelector('#six').innerHTML = `
                <div class="container" id="component_green" style="border-color:${state.color}; font-size:18px">
                  ${state.text}
                </div>
            `;
      }
      store.subscribe(six);
      six();
    </script>
  </body>
</html>
